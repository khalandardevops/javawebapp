node{

  def buildNumber = BUILD_NUMBER
  
  stage('checkout'){
    git branch: 'main', credentialsId: 'Git_Cred', url: 'https://github.com/khalandardevops/javawebapp.git'
  }
  stage('Build'){
    sh 'mvn clean install'
  }
  stage('Docker Image Build'){
    sh "docker build -t mohdkhalandar/javawebappdockerscriptedpipeline:${buildNumber} ."
  }
  stage('Push Docker Image to Docker HUB'){
    sh "docker login -u mohdkhalandar -p QWJ1bWRrYWxpODU="
    sh "docker push mohdkhalandar/javawebappdockerscriptedpipeline:${buildNumber}"
  }
}
